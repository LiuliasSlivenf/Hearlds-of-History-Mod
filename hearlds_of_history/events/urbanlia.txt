add_namespace = urbanlia
add_namespace = urbanlia_political_struggle

# Urbanlian Civil War Starts 
country_event = {
	id = urbanlia.1
	title = urbanlia.1.t
	desc = urbanlia.1.d
	picture = GFX_report_event_chinese_soldiers_fighting
	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	option = { # Confirm
		name = urbanlia.1.a
		ai_chance = { factor = 100 }
	}
}

# Alaska for Pacific States, Event for Canada 
country_event = {
	id = urbanlia.2
	title = mtg_usa_canadian_corridor.1.t
	desc = mtg_usa_canadian_corridor.1.desc
	picture = GFX_report_event_canada_patriation
	
	is_triggered_only = yes
	option = { #agree
		name = mtg_usa_canadian_corridor.1.a
		ai_chance = {
			factor = 70
			modifier = {
				is_in_faction = no
				factor = 100
			}
		}
		add_stability = -0.05
		FROM = {
			country_event = mtg_usa_canadian_corridor.2
		}
		effect_tooltip = {
			FROM = {
				transfer_state = 740
				transfer_state = 473
				transfer_state = 739
				transfer_state = 471
			}
		}
	}
	option = { #refuse
		name = mtg_usa_canadian_corridor.1.b
		ai_chance = {
			factor = 30
			modifier = {
				is_in_faction = yes
				factor = 0
			}
		}
		add_war_support = 0.05
		set_country_flag = north_american_dominion_refused
		FROM = {
			country_event = mtg_usa_canadian_corridor.3
		}

		effect_tooltip = {
			FROM = {
				create_wargoal = {
					type = take_state
					target = ROOT
					generator = { 740 473 739 471 }
				}
			}
		}
	}
}


# Alaska for Pacific States: STE asks for states
country_event = {
	id = urbanlia.3
	title = urbanlia.3.t
	desc = urbanlia.3.d
	picture = GFX_report_event_chinese_soldiers_fighting
	
	is_triggered_only = yes
	trigger = {
    tag = URB
		country_exists = STE
		controls_state = 740
		controls_state = 471
		controls_state = 473
		controls_state = 739
  }
	mean_time_to_happen = {
		days = 1
	}
	option = { # Okay
		name = urbanlia.3.a
		ai_chance = { base = 100 }
		STE = {
			transfer_state = 740
			transfer_state = 473
			transfer_state = 739
			transfer_state = 471
		}
	}
}

# Invite STE Ambassadors, message for STE
country_event = {
	id = urbanlia.4
	title = urbanlia.4.t
	desc = urbanlia.4.d
	picture = GFX_report_event_chinese_soldiers_fighting
	
	is_triggered_only = yes
	option = { # Agree
		name = urbanlia.4.a
		ai_chance = { factor = 100 }
		effect_tooltip = {
      save_event_target_as = ste_agrees
      set_country_flag = ste_agrees
      URB = { 
        set_country_flag = ste_agrees 
        country_event = { id = urbanlia.5 }
      }
		}
  }
}

# Invite STE Ambassadors, message for URB
country_event = {
	id = urbanlia.5
	title = urbanlia.4.t
	desc = urbanlia.5.d
	picture = GFX_report_event_chinese_soldiers_fighting
	
	is_triggered_only = yes
	option = { # Fine
		name = urbanlia.5.a
		ai_chance = { factor = 100 }
		effect_tooltip = {
      URB = { add_political_power = 20 }
		}
  }
}

# Urbanlian Civil War Ends
country_event = {
	id = urbanlia.6
	title = urbanlia.6.t
	desc = urbanlia.6.d
	picture = GFX_report_event_spain_civil_war_soldiers
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = { # Finally
		name = urbanlia.6.a
		ai_chance = { factor = 100 }
	}
}

# Alliance between STE and URB
country_event = {
	id = urbanlia.7
	title = urbanlia.7.t
	desc = urbanlia.7.d
	picture = GFX_report_event_soviet_german_soldier_handshake
	
	is_triggered_only = yes
	
	option = { # Agree
		name = urbanlia.7.a
		ai_chance = { 
      factor = 50 
			modifier = {
				has_war = yes
				is_in_faction = no
				factor = 100
			}
			modifier = {
        has_opinion = { target = ROOT value > 49 }
				factor = 100
			}
			modifier = {
				has_idea = like_minded_friends 
				factor = 100
			}
    }
		FROM = {
			country_event = urbanlia.8
		}
		if = {
      limit = {
        FROM = {
          is_in_faction = yes
        }
        OR = {
          is_in_faction = no
          is_literally_urbanlia = yes
        }
      }
      leave_faction = ROOT
      FROM = { add_to_faction = ROOT }
		}
		if = {
      limit = {
        FROM = {
          is_in_faction = no
        }
        is_in_faction = yes
      }
      add_to_faction = FROM 
		}
		hidden_effect = {
			news_event = { hours = 1 id = urb_news.5 }
		}
	}
	option = { # Reject
		name = urbanlia.7.b
		ai_chance = { 
      factor = 10 
			modifier = {
				has_war = yes
				is_in_faction = yes
				is_faction_leader = no
				factor = 100
			}
			modifier = {
        has_opinion = { target = ROOT value < 50 }
				factor = 100
			}
			modifier = {
				has_idea = like_minded_friends 
				factor = 0
			}
		}
		FROM = {
			country_event = urbanlia.9
		}
	}
	option = { # Guarantee
		name = urbanlia.7.c
		ai_chance = { 
      factor = 40 
			modifier = {
				has_idea = like_minded_friends 
				factor = 0
			}
		}
		FROM = {
			country_event = urbanlia.10
      diplomatic_relation = {
        country = ROOT
        relation = guarantee
        active = yes
      }
		}
	}
}

# Alliance between STE and URB, FROM joins the faction
country_event = {
	id = urbanlia.8
	title = urbanlia.8.t
	desc = urbanlia.8.d
	picture = GFX_report_event_second_vienna_award_pact
	
	is_triggered_only = yes
	
	option = { # Confirm
		name = urbanlia.8.a
		ai_chance = { factor = 100 }
	}
}

# Alliance between STE and URB, FROM rejects the faction
country_event = {
	id = urbanlia.9
	title = urbanlia.9.t
	desc = urbanlia.9.d
	picture = GFX_report_event_second_vienna_award_pact
	
	is_triggered_only = yes
	
	option = { # Confirm
		name = urbanlia.9.a
		ai_chance = { factor = 100 }
	}
}

# Alliance between STE and URB, FROM rejects the faction but agrees the guarantee
country_event = {
	id = urbanlia.10
	title = urbanlia.10.t
	desc = urbanlia.10.d
	picture = GFX_report_event_second_vienna_award_pact
	
	is_triggered_only = yes
	
	option = { # Confirm
		name = urbanlia.10.a
		ai_chance = { factor = 100 }
	}
}

### Political Struggle ###


# Foundation of the Left Wing United Front
country_event = {
	id = urbanlia_political_struggle.11
	title = urbanlia_political_struggle.11.t
	desc = urbanlia_political_struggle.11.d
	picture = GFX_report_event_communist_leader
	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	option = { # Confirm
		name = urbanlia_political_struggle.11.a
		add_popularity = {
      ideology = communism
      popularity = 0.15
    }
		hidden_effect = {
      set_party_name = { ideology = communism long_name = URB_left_wing_united_front_party_long name = URB_left_wing_united_front_party }
		}
	}
}

# Foundation of the Constitutional Amendment Coalition
country_event = {
	id = urbanlia_political_struggle.12
	title = urbanlia_political_struggle.12.t
	desc = urbanlia_political_struggle.12.d
	picture = GFX_report_event_FDR_speech
	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	option = { # Confirm
		name = urbanlia_political_struggle.12.a
		add_popularity = {
      ideology = democratic
      popularity = 0.1
    }
		hidden_effect = {
      set_party_name = { ideology = democratic long_name = URB_constitutional_amendment_coalition_party_long name = URB_constitutional_amendment_coalition_party }
		}
	}
}

# Curley heads to Loslenn
country_event = {
	id = urbanlia_political_struggle.13
	title = urbanlia_political_struggle.13.t
	desc = urbanlia_political_struggle.13.d
	picture = GFX_report_event_journalists_speech
	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	option = { # Confirm
		name = urbanlia_political_struggle.13.a
		set_global_flag = urb_curley_heads_to_loslenn
		#In NSB there should be an effect to transfer the character from MSA to UBF, or just create another one
	}
}
